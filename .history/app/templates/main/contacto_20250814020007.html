{% extends 'base.html' %}
{% block title %}Contacto – IndepSalud{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto py-12 px-4">

  <!-- HERO compacto con SaniBot -->
  <div class="bg-gradient-to-r from-[#007BFF] to-[#00C2FF] rounded-2xl p-6 md:p-7 text-white shadow-lg mb-4 flex items-center gap-4">
    <img src="{{ url_for('static', filename='images/sanibot.png') }}" alt="" class="w-16 h-16 drop-shadow-xl hidden sm:block">
    <div class="flex-1">
      <h1 class="text-2xl md:text-3xl font-extrabold">¿En qué podemos ayudarte?</h1>
      <p class="text-white/90">SaniBot te guía y nuestro equipo responde en el menor tiempo posible.</p>
    </div>
    <button type="button" id="sanibotQuick" class="px-4 py-2 bg-white text-[#007BFF] font-bold rounded-xl shadow hover:shadow-md">
      Ayuda rápida
    </button>
  </div>

  <!-- SaniBot Tips (debajo del hero) -->
<!-- SaniBot Tips – Banner cerrable -->
<div id="sanibotBanner" class="relative overflow-hidden rounded-2xl border border-[#e9f3ff] mb-8">
  <div class="absolute inset-0 bg-gradient-to-r from-[#F0F9FF] via-white to-[#F0F9FF]"></div>
  <div class="relative z-10 p-5 flex items-start gap-4">
    <img src="{{ url_for('static', filename='images/sanibot.png') }}" alt="SaniBot" class="w-10 h-10">
    <div class="flex-1">
      <h3 class="font-bold text-[#0d3b66] mb-1">SaniBot Tips</h3>
      <div class="grid md:grid-cols-3 gap-3 text-sm">
        <div class="flex items-start gap-2">
          <i class="fas fa-check-circle text-[#00C2FF] mt-0.5"></i>
          <span>Elige el <b>motivo</b> adecuado.</span>
        </div>
        <div class="flex items-start gap-2">
          <i class="fas fa-clock text-[#007BFF] mt-0.5"></i>
          <span>Tiempo de respuesta <b>&lt; 24h</b>.</span>
        </div>
        <div class="flex items-start gap-2">
          <i class="fas fa-user-shield text-emerald-600 mt-0.5"></i>
          <span>Evita <b>datos sensibles</b>.</span>
        </div>
      </div>
    </div>
    <button type="button" class="text-gray-400 hover:text-gray-600" onclick="document.getElementById('sanibotBanner').remove()" aria-label="Cerrar">
      <i class="fas fa-times"></i>
    </button>
  </div>
</div>






  <!-- Layout 2 columnas -->


    <!-- Columna principal: Formulario -->
    <div class="md:col-span-2">
      <div class="bg-white rounded-2xl shadow-lg p-8 border border-[#00C2FF]/10">

        <div class="flex items-center gap-3 mb-4">
          <i class="fas fa-envelope-open-text text-2xl text-[#007BFF]"></i>
          <h2 class="text-xl md:text-2xl font-extrabold text-[#0d3b66]">Contáctanos</h2>
        </div>
        <p class="mb-6 text-gray-700">
          ¿Tienes dudas, sugerencias o necesitas ayuda con tu atención en <span class="font-semibold">IndepSalud</span>? Completa el formulario y te responderemos a la brevedad.
        </p>

        <!-- FLASH -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, msg in messages %}
              <div class="rounded-lg p-3 mb-4 text-center font-semibold
                {% if category == 'success' %}bg-green-50 text-green-700 border border-green-200
                {% elif category == 'danger' %}bg-red-50 text-red-700 border border-red-200
                {% else %}bg-blue-50 text-blue-700 border border-blue-200{% endif %}">{{ msg }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form method="POST" class="space-y-5" autocomplete="off" id="contactForm">
          {{ form.hidden_tag() }}

          <!-- Honeypot anti‑spam (no tocar name/id) -->
          <div class="hidden">
            <label>Deja este campo vacío</label>
            <input type="text" name="website" tabindex="-1" autocomplete="off">
          </div>

          <!-- Nombre -->
          <div>
            <label for="nombre" class="block text-[#0d3b66] font-bold mb-1">Nombre</label>
            <div class="relative">
              <i class="fas fa-user absolute left-3 top-3 text-gray-400"></i>
              {{ form.nombre(class_="pl-10 pr-3 py-2 w-full border border-gray-300 rounded-lg bg-[#f6faff] text-gray-900 focus:ring-2 focus:ring-[#00C2FF] focus:border-[#00C2FF] transition", id="nombre", placeholder="Tu nombre") }}
            </div>
            {% if form.nombre.errors %}
              <div class="text-red-600 text-xs mt-1">{{ form.nombre.errors[0] }}</div>
            {% endif %}
          </div>

          <!-- Email -->
          <div>
            <label for="email" class="block text-[#0d3b66] font-bold mb-1">Correo electrónico</label>
            <div class="relative">
              <i class="fas fa-envelope absolute left-3 top-3 text-gray-400"></i>
              {{ form.email(class_="pl-10 pr-3 py-2 w-full border border-gray-300 rounded-lg bg-[#f6faff] text-gray-900 focus:ring-2 focus:ring-[#00C2FF] focus:border-[#00C2FF] transition", id="email", placeholder="tu@correo.com") }}
            </div>
            {% if form.email.errors %}
              <div class="text-red-600 text-xs mt-1">{{ form.email.errors[0] }}</div>
            {% endif %}
          </div>

          <!-- Mensaje -->
          <div>
            <label for="mensaje" class="block text-[#0d3b66] font-bold mb-1">Mensaje</label>
            <div class="relative">
              <i class="fas fa-comment-dots absolute left-3 top-4 text-gray-400"></i>
              {{ form.mensaje(class_="pl-10 pr-3 py-2 w-full border border-gray-300 rounded-lg bg-[#f6faff] text-gray-900 focus:ring-2 focus:ring-[#00C2FF] focus:border-[#00C2FF] transition resize-none", id="mensaje", placeholder="Escribe tu mensaje aquí...", rows="4") }}
            </div>
            <div class="flex items-center justify-between mt-1">
              <small class="text-gray-500">Sé específico para ayudarte mejor.</small>
              <small id="charCount" class="text-gray-400">0/500</small>
            </div>
            {% if form.mensaje.errors %}
              <div class="text-red-600 text-xs mt-1">{{ form.mensaje.errors[0] }}</div>
            {% endif %}
          </div>

          <!-- Consentimiento -->
          <div class="flex items-start gap-2 bg-[#f8fbff] border border-[#e6f4ff] rounded-lg p-3">
            <input id="consent" type="checkbox" class="mt-1 h-4 w-4 accent-[#007BFF]">
            <label for="consent" class="text-sm text-gray-700">
              Acepto ser contactado/a por IndepSalud y declaro haber leído los
              <a href="" class="text-[#007BFF] underline">Términos</a> y
              <a href="" class="text-[#007BFF] underline">Privacidad</a>.
            </label>
          </div>

          <!-- Botones -->
          <div class="flex flex-col sm:flex-row gap-3">
            <button type="submit" id="submitBtn"
              class="w-full sm:w-auto px-5 py-3 bg-[#007BFF] hover:bg-[#005BB5] text-white font-bold rounded-lg shadow transition disabled:opacity-60 disabled:cursor-not-allowed">
              <i class="fas fa-paper-plane mr-2"></i> Enviar mensaje
            </button>
            <a href="https://wa.me/56900000000?text=Hola%20IndepSalud%2C%20necesito%20ayuda"
               class="w-full sm:w-auto px-5 py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg shadow transition text-center">
              <i class="fab fa-whatsapp mr-2"></i> Escribir por WhatsApp
            </a>
          </div>
        </form>

        <!-- Otras vías (debajo del formulario) -->
        <div class="mt-6 bg-white rounded-2xl shadow p-6 border border-[#e9f3ff]">
          <h4 class="font-bold text-[#0d3b66] mb-2">Otras vías</h4>
          <p class="text-sm text-gray-600">
            Correo: <a href="mailto:contacto@indepsalud.cl" class="text-[#007BFF] underline">contacto@indepsalud.cl</a><br>
            Soporte: <a href="mailto:soporte@indepsalud.cl" class="text-[#007BFF] underline">soporte@indepsalud.cl</a>
          </p>
        </div>

        <div class="mt-6 text-xs text-gray-500">
          IndepSalud no presta servicios médicos; conecta pacientes con profesionales independientes. Ante emergencias, llama al 131.
        </div>
      </div>
    </div>

    <!-- Columna lateral (vacía o futura): puedes usarla para FAQs, horarios, etc. -->
    <div class="hidden md:block"></div>

  </div>
</div>

<!-- JS: contador, bloqueo hasta consentimiento, límite de 500, ayuda SaniBot -->
<script>
(function(){
  const msg = document.getElementById('mensaje');
  const count = document.getElementById('charCount');
  const submit = document.getElementById('submitBtn');
  const consent = document.getElementById('consent');
  const quick = document.getElementById('sanibotQuick');

  function updateCount(){
    if(!msg || !count) return;
    const max = 500;
    const len = (msg.value || '').length;
    count.textContent = len + '/' + max;
    if(len > max){ msg.value = msg.value.slice(0, max); count.textContent = max + '/' + max; }
  }

  msg && msg.addEventListener('input', updateCount);
  updateCount();

  // Deshabilita enviar hasta que haya consentimiento
  function updateConsent(){ submit && (submit.disabled = !consent.checked); }
  consent && consent.addEventListener('change', updateConsent);
  updateConsent();

  quick && quick.addEventListener('click', function(){
    alert(
`SaniBot:
• Selecciona el motivo más cercano a tu consulta.
• Describe tu caso en 3-5 líneas con datos clave (ciudad, especialidad, orden de compra si aplica).
• Para soporte urgente usa WhatsApp.`
    );
  });
})();
</script>
{% endblock %}
