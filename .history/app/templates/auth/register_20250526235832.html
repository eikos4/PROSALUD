{% extends 'base.html' %}
{% block title %}Registrarse â€“ IndepWork{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-[#F5F7FA] via-[#ECF4FF] to-[#E3F7FB] py-10 relative overflow-hidden">
  <!-- Bubble background decoration -->
  <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[50vw] h-[50vw] bg-[#276EF1]/10 rounded-full blur-2xl z-0"></div>
  <div class="absolute bottom-0 right-0 w-[30vw] h-[30vw] bg-[#FF8800]/10 rounded-full blur-2xl z-0"></div>
  <div class="w-full max-w-2xl mx-auto relative z-10">

    <!-- Encabezado amigable -->
    <div class="mb-6 text-center">
      <h1 class="text-3xl md:text-4xl font-extrabold text-[#23272F] mb-2">Â¡Bienvenido a IndepWork!</h1>
      <p class="text-[#4C5B6B] text-lg">Â¿QuÃ© te gustarÃ­a hacer hoy? <br>
        <span class="text-[#276EF1] font-semibold">Contratar un profesional</span> o <span class="text-[#FF8800] font-semibold">Ofrecer tus servicios</span>
      </p>
    </div>

    <!-- Selector visual de tipo de cuenta -->
    <div class="mb-5 grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Card Cliente -->
      <div id="select-cliente" tabindex="0"
        class="cursor-pointer group bg-white/80 hover:bg-[#EAF3FF] border-2 border-transparent hover:border-[#276EF1] rounded-2xl p-7 shadow-xl transition
              flex flex-col items-center ring-0 focus:outline-none select-none relative"
        onclick="selectRole('client')" onkeydown="if(event.key==='Enter'){selectRole('client')}"
        aria-label="Selecciona cliente"
      >
        <div class="w-16 h-16 flex items-center justify-center rounded-full bg-[#276EF1]/20 mb-3 shadow group-hover:scale-105 transition-transform">
          <svg class="h-9 w-9 text-[#276EF1]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 01-8 0m8 8a4 4 0 00-8 0m14 5H2a1 1 0 01-1-1v-2a7 7 0 0114 0v2a1 1 0 01-1 1z" />
          </svg>
        </div>
        <h3 class="text-xl font-bold text-[#276EF1] mb-1">Quiero contratar</h3>
        <p class="text-[#23272F] text-base mb-2 italic">Buscar y contratar servicios con confianza</p>
        <ul class="text-gray-600 text-sm mb-2 space-y-1">
          <li>âœ“ Encuentra expertos verificados</li>
          <li>âœ“ Elige segÃºn tu presupuesto</li>
          <li>âœ“ Recibe ayuda rÃ¡pida y fÃ¡cil</li>
        </ul>
        <span class="absolute top-3 right-5 hidden group-[.selected]:inline-block bg-[#276EF1] text-white text-xs font-semibold px-2 py-0.5 rounded">Seleccionado</span>
      </div>
      <!-- Card Profesional -->
      <div id="select-profesional" tabindex="0"
        class="cursor-pointer group bg-white/80 hover:bg-[#FFF5EB] border-2 border-transparent hover:border-[#FF8800] rounded-2xl p-7 shadow-xl transition
              flex flex-col items-center ring-0 focus:outline-none select-none relative"
        onclick="selectRole('professional')" onkeydown="if(event.key==='Enter'){selectRole('professional')}"
        aria-label="Selecciona profesional"
      >
        <div class="w-16 h-16 flex items-center justify-center rounded-full bg-[#FF8800]/20 mb-3 shadow group-hover:scale-105 transition-transform">
          <svg class="h-9 w-9 text-[#FF8800]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 14l9-5-9-5-9 5 9 5zm0 7v-7" />
          </svg>
        </div>
        <h3 class="text-xl font-bold text-[#FF8800] mb-1">Quiero ofrecer servicios</h3>
        <p class="text-[#23272F] text-base mb-2 italic">Conecta con nuevos clientes y haz crecer tu negocio</p>
        <ul class="text-gray-600 text-sm mb-2 space-y-1">
          <li>âœ“ Publica tu experiencia en minutos</li>
          <li>âœ“ Responde solicitudes directo al chat</li>
          <li>âœ“ Recibe pagos online, Â¡sin complicaciones!</li>
        </ul>
        <span class="absolute top-3 right-5 hidden group-[.selected]:inline-block bg-[#FF8800] text-white text-xs font-semibold px-2 py-0.5 rounded">Seleccionado</span>
      </div>
    </div>
    <!-- Nota amigable -->
    <div class="mb-7 text-center text-xs text-gray-500">
      Puedes cambiar de opciÃ³n en cualquier momento antes de registrarte. ðŸ˜Š
    </div>

    <!-- FORMULARIO DE REGISTRO -->
    <div class="relative bg-white/95 p-10 rounded-2xl shadow-2xl backdrop-blur-lg border border-[#F3F4F6]">
      <h2 class="text-2xl font-bold text-center mb-5 text-[#23272F]">Crea tu cuenta gratis</h2>
      <form method="POST" novalidate class="space-y-5" id="register-form">
        {{ form.hidden_tag() }}
        <div>
          {{ form.username.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.username(class_='w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.email.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.email(class_='w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.password.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.password(class_='w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.password2.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.password2(class_='w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div class="hidden">
          {{ form.role.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.role(class_='w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <button type="submit"
          class="w-full py-3 mt-2 bg-[#276EF1] hover:bg-[#1E5BB8] text-white rounded-lg font-semibold shadow transition text-lg hover:scale-[1.03] focus:scale-[.98] duration-100">
          Â¡Crear mi cuenta ahora!
        </button>
      </form>
      <p class="mt-8 text-center text-gray-600">
        Â¿Ya tienes cuenta? <a href="{{ url_for('auth.login') }}"
          class="text-[#FF8800] hover:text-[#CC7700] font-semibold transition">Inicia sesiÃ³n</a>
      </p>
    </div>
  </div>
</div>

<script>
  // Interactividad para resaltar la card seleccionada y setear el valor del select/field WTForm (si es un <select>)
  function selectRole(role) {
    // Quita la selecciÃ³n visual
    document.getElementById('select-cliente').classList.remove('border-[#276EF1]', 'ring-2', 'selected');
    document.getElementById('select-profesional').classList.remove('border-[#FF8800]', 'ring-2', 'selected');
    // Marca la seleccionada
    if (role === 'client') {
      document.getElementById('select-cliente').classList.add('border-[#276EF1]', 'ring-2', 'ring-[#276EF1]/20', 'selected');
    } else if (role === 'professional') {
      document.getElementById('select-profesional').classList.add('border-[#FF8800]', 'ring-2', 'ring-[#FF8800]/20', 'selected');
    }
    // Setea el campo del form
    const roleField = document.querySelector('select[name="role"], input[name="role"]');
    if (roleField) {
      roleField.value = role;
    }
  }

  // Opcional: Si quieres seleccionar la card segÃºn el valor inicial del select
  window.addEventListener('DOMContentLoaded', function () {
    const roleField = document.querySelector('select[name="role"], input[name="role"]');
    if (roleField && roleField.value) {
      selectRole(roleField.value);
    }
  });
</script>
{% endblock %}
