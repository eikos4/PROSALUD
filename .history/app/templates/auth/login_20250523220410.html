<!-- app/templates/auth/login.html -->
{% extends 'base.html' %}
{% block title %}Iniciar Sesión – IndepWork{% endblock %}

{% block content %}
<div class="min-h-screen relative bg-cover bg-center" style="background-image: url('{{ url_for('static', filename='images/fondo3.png') }}')">
  <div class="absolute inset-0 bg-gradient-to-br from-black/70 via-black/50 to-black/70"></div>
  <div class="relative z-10 flex flex-col lg:flex-row items-center justify-center min-h-screen px-4 lg:px-16 py-12">

    <!-- Login Form -->
    <div class="w-full lg:w-1/2 bg-white bg-opacity-90 p-10 rounded-2xl shadow-2xl backdrop-blur-md">

      <h2 class="text-4xl font-extrabold text-[#333333] mb-8 text-center">IndepWork</h2>
      <!-- FLASH MESSAGES -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mb-6">
            {% for category, msg in messages %}
              <div class="rounded-lg p-3 mb-2 text-center 
                {% if category == 'success' %}bg-green-100 text-green-700{% elif category == 'warning' %}bg-yellow-100 text-yellow-700{% elif category == 'danger' %}bg-red-100 text-red-700{% else %}bg-blue-100 text-blue-700{% endif %}">
                {{ msg }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <form method="POST" novalidate class="space-y-6" id="loginForm">
        {{ form.hidden_tag() }}
        <div>
          {{ form.email.label(class_='block text-[#333333] mb-2') }}
          {{ form.email(
            class_='w-full px-5 py-3 bg-gray-100 text-black border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#276EF1]' ~ (' border-red-400' if form.email.errors else ' border-gray-300'),
            placeholder='correo@ejemplo.com',
            autocomplete='email'
          ) }}
          {% if form.email.errors %}
            <div class="text-red-600 text-sm mt-1">{{ form.email.errors[0] }}</div>
          {% endif %}
        </div>
        <div>
          {{ form.password.label(class_='block text-[#333333] mb-2') }}
          {{ form.password(
            class_='w-full px-5 py-3 bg-gray-100 text-black border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#276EF1]' ~ (' border-red-400' if form.password.errors else ' border-gray-300'),
            placeholder='Tu contraseña',
            autocomplete='current-password'
          ) }}
          {% if form.password.errors %}
            <div class="text-red-600 text-sm mt-1">{{ form.password.errors[0] }}</div>
          {% endif %}
        </div>

        <div class="flex items-center justify-between">
          <div class="flex items-center">
            {{ form.remember_me(class_='h-4 w-4 text-[#276EF1]') }}
            {{ form.remember_me.label(class_='ml-2 text-gray-700') }}
          </div>
          <a href="#" class="text-sm text-[#FF8800] hover:underline">¿Olvidaste tu contraseña?</a>
        </div>
        <button type="submit" id="btn-login" class="w-full py-4 bg-[#276EF1] hover:bg-[#1E5BB8] text-white rounded-lg font-semibold text-lg transition flex items-center justify-center gap-2">
          <span id="btn-text">{{ form.submit.label.text }}</span>
          <svg id="spinner" class="animate-spin hidden h-6 w-6 text-white" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
          </svg>
        </button>
      </form>
      <p class="mt-8 text-center text-gray-700">¿No tienes cuenta? <a href="{{ url_for('auth.register') }}" class="text-[#FF8800] hover:text-[#CC7700] font-medium">Regístrate</a></p>
    </div>

    <!-- Benefits Panel -->
    <div class="mt-12 lg:mt-0 lg:ml-16 w-full lg:w-1/3 text-white">
      <h3 class="text-3xl font-bold mb-6">¿Por qué elegir IndepWork?</h3>
      <ul class="space-y-6">
        {% for title, text, icon in [
          ('Profesionales verificados','Trabaja con expertos certificados en tu área y gana confianza.','fa-search'),
          ('Publicación sencilla','Crea y administra tus servicios en pocos clics.','fa-briefcase'),
          ('Chat seguro','Comunícate directamente sin salir de la plataforma.','fa-comments'),
          ('Reseñas auténticas','Conoce la experiencia real de otros clientes.','fa-thumbs-up'),
          ('Pagos protegidos','Transacciones seguras con métodos confiables.','fa-lock')
        ] %}
        <li class="flex items-start">
          <div class="flex-shrink-0">
            <span class="inline-flex items-center justify-center h-12 w-12 rounded-full bg-[#FF8800]/30 text-[#FF8800] text-xl">
              <i class="fas {{ icon }}"></i>
            </span>
          </div>
          <div class="ml-5">
            <h4 class="text-xl font-semibold">{{ title }}</h4>
            <p class="mt-1 text-gray-200">{{ text }}</p>
          </div>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<script>
  // Spinner feedback UX
  const loginForm = document.getElementById('loginForm');
  if (loginForm) {
    loginForm.addEventListener('submit', function () {
      document.getElementById('btn-text').textContent = 'Entrando...';
      document.getElementById('spinner').classList.remove('hidden');
    });
  }
</script>
{% endblock %}
