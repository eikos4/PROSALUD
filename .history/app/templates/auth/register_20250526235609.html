{% extends 'base.html' %}
{% block title %}Registrarse – IndepWork{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-[#F5F7FA] to-[#DCE6F7] py-10">
  <div class="w-full max-w-2xl mx-auto">

    <!-- Selector visual de tipo de cuenta -->
    <div class="mb-10 grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Card Cliente -->
      <div id="select-cliente" tabindex="0"
        class="cursor-pointer group bg-white/80 hover:bg-[#EAF3FF] border-2 border-transparent hover:border-[#276EF1] rounded-2xl p-7 shadow-xl transition
              flex flex-col items-center ring-0 focus:outline-none"
        onclick="selectRole('client')" onkeydown="if(event.key==='Enter'){selectRole('client')}"
      >
        <div class="w-16 h-16 flex items-center justify-center rounded-full bg-[#276EF1]/20 mb-4 shadow group-hover:scale-105 transition-transform">
          <svg class="h-9 w-9 text-[#276EF1]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 01-8 0m8 8a4 4 0 00-8 0m14 5H2a1 1 0 01-1-1v-2a7 7 0 0114 0v2a1 1 0 01-1 1z" />
          </svg>
        </div>
        <h3 class="text-xl font-bold text-[#276EF1] mb-2">Quiero contratar (Cliente)</h3>
        <ul class="text-gray-600 text-base mb-2 space-y-1">
          <li>✓ Encuentra profesionales calificados</li>
          <li>✓ Compara perfiles y precios</li>
          <li>✓ Gestiona tus proyectos fácilmente</li>
          <li>✓ Chatea y contrata seguro</li>
        </ul>
      </div>
      <!-- Card Profesional -->
      <div id="select-profesional" tabindex="0"
        class="cursor-pointer group bg-white/80 hover:bg-[#FFF5EB] border-2 border-transparent hover:border-[#FF8800] rounded-2xl p-7 shadow-xl transition
              flex flex-col items-center ring-0 focus:outline-none"
        onclick="selectRole('professional')" onkeydown="if(event.key==='Enter'){selectRole('professional')}"
      >
        <div class="w-16 h-16 flex items-center justify-center rounded-full bg-[#FF8800]/20 mb-4 shadow group-hover:scale-105 transition-transform">
          <svg class="h-9 w-9 text-[#FF8800]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 14l9-5-9-5-9 5 9 5zm0 7v-7" />
          </svg>
        </div>
        <h3 class="text-xl font-bold text-[#FF8800] mb-2">Quiero ofrecer mis servicios</h3>
        <ul class="text-gray-600 text-base mb-2 space-y-1">
          <li>✓ Publica tu experiencia y habilidades</li>
          <li>✓ Recibe solicitudes y chatea con clientes</li>
          <li>✓ Administra tu disponibilidad y agenda</li>
          <li>✓ Recibe pagos online y gana reputación</li>
        </ul>
      </div>
    </div>

    <!-- FORMULARIO DE REGISTRO -->
    <div class="relative bg-white/90 p-10 rounded-2xl shadow-2xl backdrop-blur-lg border border-[#F3F4F6]">
      <h2 class="text-3xl font-extrabold text-center mb-7 text-[#23272F]">Crea tu cuenta gratis</h2>
      <form method="POST" novalidate class="space-y-5" id="register-form">
        {{ form.hidden_tag() }}
        <div>
          {{ form.username.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.username(class_='w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.email.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.email(class_='w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.password.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.password(class_='w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.password2.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.password2(class_='w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <div>
          {{ form.role.label(class_='block text-[#23272F] mb-2 font-semibold') }}
          {{ form.role(class_='w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-[#23272F] focus:ring-2 focus:ring-[#276EF1]') }}
        </div>
        <button type="submit"
          class="w-full py-3 mt-4 bg-[#276EF1] hover:bg-[#1E5BB8] text-white rounded-lg font-semibold shadow transition text-lg">
          {{ form.submit.label.text }}
        </button>
      </form>
      <p class="mt-8 text-center text-gray-600">
        ¿Ya tienes cuenta? <a href="{{ url_for('auth.login') }}"
          class="text-[#FF8800] hover:text-[#CC7700] font-semibold transition">Inicia sesión</a>
      </p>
    </div>
  </div>
</div>

<script>
  // Interactividad para resaltar la card seleccionada y setear el valor del select/field WTForm (si es un <select>)
  function selectRole(role) {
    // Quita la selección visual
    document.getElementById('select-cliente').classList.remove('border-[#276EF1]', 'ring-2');
    document.getElementById('select-profesional').classList.remove('border-[#FF8800]', 'ring-2');
    // Marca la seleccionada
    if (role === 'client') {
      document.getElementById('select-cliente').classList.add('border-[#276EF1]', 'ring-2', 'ring-[#276EF1]/20');
    } else if (role === 'professional') {
      document.getElementById('select-profesional').classList.add('border-[#FF8800]', 'ring-2', 'ring-[#FF8800]/20');
    }
    // Setea el campo del form
    const roleField = document.querySelector('select[name="role"], input[name="role"]');
    if (roleField) {
      roleField.value = role;
    }
  }

  // Opcional: Si quieres seleccionar la card según el valor inicial del select
  window.addEventListener('DOMContentLoaded', function () {
    const roleField = document.querySelector('select[name="role"], input[name="role"]');
    if (roleField && roleField.value) {
      selectRole(roleField.value);
    }
  });
</script>
{% endblock %}
