{% extends 'base.html' %}
{% block title %}Evaluaciones recibidas{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto py-12 px-2 animate-fade-in">
  <!-- Título -->
  <div class="flex items-center gap-4 mb-10">
    <div class="bg-[#FF8800]/20 rounded-full p-3 shadow">
      <i class="fas fa-star-half-alt text-2xl text-[#FF8800]"></i>
    </div>
    <h2 class="text-3xl font-black text-[#276EF1] tracking-tight">Evaluaciones de clientes</h2>
  </div>

  {% if evaluaciones %}
    <div class="space-y-8">
      {% for ev in evaluaciones %}
        <div class="bg-white rounded-3xl shadow-xl border border-[#276EF1]/10 group flex gap-6 p-8 items-center transition-all duration-300 hover:shadow-2xl hover:border-[#276EF1]/30 hover:ring-4 hover:ring-[#276EF1]/10 relative animate-fade-in-up">
          <!-- Badge de evaluación reciente -->
          {% if loop.index0 == 0 %}
          <span class="absolute -top-4 left-5 bg-gradient-to-r from-[#FF8800] to-[#ffd700] text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg animate-bounce">¡Nueva!</span>
          {% endif %}

          <!-- Avatar y datos del cliente -->
          <div class="flex flex-col items-center flex-shrink-0 w-28">
            <div class="relative">
              <img src="{{ ev.client.profile_image_url or url_for('static', filename='images/placeholder.png') }}"
                   alt="{{ ev.client.username }}"
                   class="w-24 h-24 rounded-full object-cover border-4 border-[#276EF1]/50 shadow group-hover:scale-105 transition duration-300">
              <span class="absolute -bottom-2 left-1/2 -translate-x-1/2 bg-[#f6fbff] text-[#276EF1] px-2 py-0.5 rounded-full text-xs font-bold border border-[#276EF1]/20 shadow">Cliente</span>
            </div>
            <span class="mt-4 text-sm text-[#276EF1] font-bold truncate max-w-[100px]" title="{{ ev.client.username }}">
              <i class="fas fa-user-circle"></i> {{ ev.client.username }}
            </span>
          </div>
          <!-- Contenido de la evaluación -->
          <div class="flex-1">
            <div class="flex flex-col sm:flex-row sm:items-center sm:gap-4 mb-2">
              <!-- Estrellas -->
              <div class="flex gap-1 items-center text-lg">
                {% for i in range(1, 6) %}
                  {% if i <= ev.rating %}
                    <i class="fas fa-star text-yellow-400 animate-star"></i>
                  {% else %}
                    <i class="far fa-star text-gray-200"></i>
                  {% endif %}
                {% endfor %}
              </div>
              <span class="mt-1 sm:mt-0 text-xs text-gray-500 font-semibold flex items-center gap-1">
                <i class="fas fa-calendar-alt"></i>
                {{ ev.created_at.strftime('%d-%m-%Y') }}
              </span>
            </div>
            <div class="bg-[#e6f3ff]/70 border-l-4 border-[#276EF1] p-4 rounded-xl text-[#164399] text-base font-semibold mb-2 leading-snug shadow-sm">
              <i class="fas fa-comment-medical mr-1 text-[#276EF1]"></i>
              "{{ ev.comment or 'Sin comentario' }}"
            </div>
            <span class="text-xs text-gray-500 italic block">
              Servicio calificado por <span class="text-[#276EF1] font-bold">{{ ev.client.full_name or ev.client.username }}</span>
            </span>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center text-gray-400 mt-14 bg-white rounded-3xl shadow-xl p-12 border border-[#276EF1]/10 animate-fade-in-up">
      <i class="fas fa-info-circle text-5xl mb-4 text-[#FF8800]"></i>
      <p class="text-2xl font-black mb-2 text-[#164399]">Todavía no tienes evaluaciones</p>
      <p class="text-base text-[#276EF1]">Cuando un cliente califique tu servicio, aparecerá aquí.</p>
    </div>
  {% endif %}
</div>
<style>
  @keyframes star-pop {0%{transform:scale(.8);}50%{transform:scale(1.3);}100%{transform:scale(1);}}
  .animate-star { animation: star-pop 0.5s cubic-bezier(.7,.2,.3,1) }
  @keyframes fade-in-up {0%{opacity:0;transform:translateY(40px);}100%{opacity:1;transform:none;}}
  .animate-fade-in-up {animation: fade-in-up 1s cubic-bezier(.6,0,.4,1) forwards;}
  @keyframes fade-in {0%{opacity:0;}100%{opacity:1;}}
  .animate-fade-in {animation: fade-in 1.1s cubic-bezier(.6,0,.4,1) forwards;}
  @keyframes bounce {
    0%, 100% { transform: translateY(0);}
    50% { transform: translateY(-7px);}
  }
  .animate-bounce { animation: bounce 1.1s cubic-bezier(.53,.21,.29,1) 2; }
</style>
{% endblock %}
