{% extends 'base.html' %}
{% block title %}Detalle de solicitud{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto py-10 px-4 animate-fade-in">
  <h2 class="text-3xl font-bold text-[#276EF1] mb-7 flex items-center gap-2">
    <i class="fas fa-handshake"></i> Detalle de Solicitud
  </h2>

  <!-- DATOS PRINCIPALES -->
  <div class="bg-white rounded-xl shadow p-7 mb-8 flex flex-col gap-3">
    <div>
      <span class="font-semibold text-[#164399]">Profesional:</span>
      <span class="flex items-center gap-2">
        <img src="{{ req.service.professional.profile_image_url or url_for('static', filename='images/placeholder.png') }}"
             class="w-8 h-8 rounded-full border-2 border-[#276EF1]/30 object-cover" alt="avatar">
        <span class="text-[#164399] font-semibold">{{ req.service.professional.full_name or req.service.professional.username }}</span>
      </span>
    </div>
    <div>
      <span class="font-semibold text-[#164399]">Servicio:</span>
      <span class="text-gray-700 font-semibold">{{ req.service.title }}</span>
      <div class="text-gray-600 text-sm">{{ req.service.description }}</div>
    </div>
    <div>
      <span class="font-semibold text-[#164399]">Estado:</span>
      {% if req.status == 'pending' %}
        <span class="inline-block px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full font-bold text-xs">Pendiente</span>
      {% elif req.status == 'accepted' %}
        <span class="inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full font-bold text-xs">Aceptada</span>
      {% elif req.status == 'rejected' %}
        <span class="inline-block px-3 py-1 bg-red-100 text-red-700 rounded-full font-bold text-xs">Rechazada</span>
      {% elif req.status == 'completed' %}
        <span class="inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full font-bold text-xs">Completada</span>
      {% endif %}
    </div>
    <div>
      <span class="font-semibold text-[#164399]">Fecha de solicitud:</span>
      <span class="text-gray-700">{{ req.date_requested.strftime('%d-%m-%Y %H:%M') }}</span>
    </div>
    <!-- OPCIÓN DE DEJAR RESEÑA -->
    {% if req.status == 'completed' and not evaluation_exists %}
      <div class="mt-4">
        <a href="{{ url_for('client.evaluate', request_id=req.id) }}"
           class="inline-block px-7 py-3 bg-gradient-to-r from-[#FF8800] to-[#276EF1] hover:from-[#CC7700] hover:to-[#1E5BB8] text-white rounded-full font-extrabold text-lg shadow transition">
          <i class="fas fa-star mr-2"></i> Dejar reseña al profesional
        </a>
      </div>
    {% elif req.status == 'completed' and evaluation_exists %}
      <div class="mt-4">
        <span class="inline-block px-4 py-2 bg-green-100 text-green-700 rounded font-semibold shadow">
          Ya enviaste una reseña para este servicio.
        </span>
      </div>
    {% endif %}
  </div>

  <!-- CHAT -->



  
  <h3 class="text-xl font-bold text-[#FF8800] mb-3 flex items-center gap-2">
    <i class="fas fa-comments"></i> Conversación
  </h3>
  



  <div class="mt-6">
    <a href="{{ url_for('client.my_requests') }}"
       class="inline-block px-6 py-2 bg-[#276EF1] hover:bg-[#1E5BB8] text-white rounded-lg font-semibold transition mt-8">
      <i class="fas fa-arrow-left"></i> Volver a solicitudes
    </a>
  </div>
</div>

<style>
  @keyframes fade-in {0%{opacity:0;transform:translateY(40px);}100%{opacity:1;transform:none;}}
  .animate-fade-in {animation: fade-in 1.1s cubic-bezier(.6,0,.4,1) forwards;}
</style>
{% endblock %}
