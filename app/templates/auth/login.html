{% extends 'base.html' %}
{% block title %}Iniciar Sesión – IndepWork{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center relative bg-cover bg-center" style="background-image: url('{{ url_for('static', filename='images/fondo3.png') }}')">
  <!-- Overlay -->
  <div class="absolute inset-0 bg-gradient-to-br from-black/70 via-[#164399]/50 to-[#276EF1]/70"></div>
  <div class="relative z-10 w-full flex flex-col lg:flex-row items-center justify-center min-h-screen px-4 lg:px-16 py-12">

    <!-- Login Form -->
    <div class="w-full max-w-lg bg-white bg-opacity-95 p-10 rounded-2xl shadow-2xl backdrop-blur-xl animate-fade-in">
      <div class="flex items-center justify-center mb-8">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo IndepWork" class="h-16 w-auto" />
      </div>
      <h2 class="text-4xl font-extrabold text-[#164399] mb-8 text-center tracking-tight animate-fade-in delay-100">Bienvenido a IndepWork</h2>

      <!-- FLASH MESSAGES -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mb-6">
            {% for category, msg in messages %}
              <div class="rounded-lg p-3 mb-2 text-center 
                {% if category == 'success' %}bg-green-100 text-green-700{% elif category == 'warning' %}bg-yellow-100 text-yellow-700{% elif category == 'danger' %}bg-red-100 text-red-700{% else %}bg-blue-100 text-blue-700{% endif %} animate-fade-in">
                {{ msg }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <form method="POST" novalidate class="space-y-6" id="loginForm" autocomplete="on">
        {{ form.hidden_tag() }}
        <div>
          {{ form.email.label(class_='block text-[#164399] mb-2 font-semibold') }}
          {{ form.email(
            class_='w-full px-5 py-3 bg-gray-100 text-black border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#276EF1]' ~ (' border-red-400' if form.email.errors else ' border-gray-300'),
            placeholder='correo@ejemplo.com',
            autocomplete='email'
          ) }}
          {% if form.email.errors %}
            <div class="text-red-600 text-sm mt-1">{{ form.email.errors[0] }}</div>
          {% endif %}
        </div>
        <div>
          {{ form.password.label(class_='block text-[#164399] mb-2 font-semibold') }}
          {{ form.password(
            class_='w-full px-5 py-3 bg-gray-100 text-black border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#276EF1]' ~ (' border-red-400' if form.password.errors else ' border-gray-300'),
            placeholder='Tu contraseña',
            autocomplete='current-password'
          ) }}
          {% if form.password.errors %}
            <div class="text-red-600 text-sm mt-1">{{ form.password.errors[0] }}</div>
          {% endif %}
        </div>

        <div class="flex items-center justify-between">
          <div class="flex items-center">
            {{ form.remember_me(class_='h-4 w-4 text-[#276EF1] focus:ring-[#FF8800]') }}
            {{ form.remember_me.label(class_='ml-2 text-gray-700') }}
          </div>
          <a href="#" class="text-sm text-[#FF8800] hover:underline font-semibold">¿Olvidaste tu contraseña?</a>
        </div>
        <button type="submit" id="btn-login" class="w-full py-4 bg-gradient-to-r from-[#276EF1] to-[#FF8800] hover:from-[#1E5BB8] hover:to-[#CC7700] text-white rounded-lg font-bold text-lg shadow transition flex items-center justify-center gap-2 relative overflow-hidden group">
          <span id="btn-text">Iniciar Sesión</span>
          <svg id="spinner" class="animate-spin hidden h-6 w-6 text-white" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
          </svg>
          <!-- Ripple effect -->
          <span class="absolute inset-0 bg-white/10 group-hover:opacity-70 opacity-0 transition-all rounded-lg"></span>
        </button>
      </form>
      <p class="mt-8 text-center text-gray-700">¿No tienes cuenta?
        <a href="{{ url_for('auth.register') }}" class="text-[#FF8800] hover:text-[#CC7700] font-bold underline">Regístrate</a>
      </p>
      <div class="mt-8 text-xs text-gray-400 text-center">Protegido por cifrado SSL &mdash; tus datos están seguros</div>
    </div>

    <!-- Benefits Panel -->
    <div class="mt-16 lg:mt-0 lg:ml-20 w-full max-w-md text-white animate-fade-in delay-300">
      <h3 class="text-3xl font-extrabold mb-7 text-[#FF8800] drop-shadow">¿Por qué elegir IndepWork?</h3>
      <ul class="space-y-7">
        {% for title, text, icon in [
          ('Profesionales verificados','Trabaja solo con expertos certificados y gana confianza.','fa-user-check'),
          ('Publica tu oferta fácil','Tu servicio en minutos, sin complicaciones.','fa-bolt'),
          ('Chat seguro','Comunicación directa, siempre protegida.','fa-lock'),
          ('Opiniones auténticas','Conoce la experiencia de otros usuarios reales.','fa-star'),
          ('Pagos protegidos','Transacciones 100% seguras y transparentes.','fa-shield-alt')
        ] %}
        <li class="flex items-start">
          <div class="flex-shrink-0">
            <span class="inline-flex items-center justify-center h-12 w-12 rounded-full bg-[#FF8800]/20 text-[#FF8800] text-2xl shadow-lg">
              <i class="fas {{ icon }}"></i>
            </span>
          </div>
          <div class="ml-5">
            <h4 class="text-xl font-semibold">{{ title }}</h4>
            <p class="mt-1 text-gray-200">{{ text }}</p>
          </div>
        </li>
        {% endfor %}
      </ul>
      <div class="mt-10 flex justify-center">
        <a href="{{ url_for('main.search') }}" class="px-8 py-3 bg-[#276EF1] hover:bg-[#1E5BB8] rounded-lg text-white font-bold text-lg shadow transition">Explorar servicios</a>
      </div>
    </div>
  </div>
</div>

<!-- Animaciones extra -->
<style>
  @keyframes fade-in {0%{opacity:0;transform:translateY(30px);}100%{opacity:1;transform:none;}}
  .animate-fade-in {animation: fade-in 1.1s cubic-bezier(.6,0,.4,1) forwards;}
  .delay-100 {animation-delay: .1s;}
  .delay-300 {animation-delay: .3s;}
</style>
<script>
  // Spinner feedback UX
  const loginForm = document.getElementById('loginForm');
  if (loginForm) {
    loginForm.addEventListener('submit', function () {
      document.getElementById('btn-text').textContent = 'Entrando...';
      document.getElementById('spinner').classList.remove('hidden');
    });
  }
</script>
{% endblock %}
